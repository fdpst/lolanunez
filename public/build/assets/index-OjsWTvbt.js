import{a as O}from"./api-DoG2ksOD.js";import{p as W}from"./paginationMeta-BbY5dJ0C.js";import{aT as X,r as d,w as A,o as E,f as Y,e as r,b as a,n as e,ag as y,am as Z,af as C,v as S,ak as ee,I as ae,c as te,aM as le,d as x,x as $,a0 as F,a as oe}from"./main-XhKa_9tU.js";import{_ as ie}from"./ConfirmDialog-CY-Jws0o.js";import{r as P}from"./validators-CrSGMxiT.js";import{_ as re}from"./AppDateTimePicker-CGZ5NR7j.js";import{_ as se}from"./AppDrawerHeaderSection-C-4ZcHAe.js";import{P as ne}from"./vue3-perfect-scrollbar.esm-CvKV9PJx.js";import{V as I}from"./VDivider-C4lH0ooT.js";import{V as J}from"./VCard-Eaj0dfV-.js";import{V as z}from"./VCardText-B_O88IhU.js";import{V as de}from"./VForm-BH9swDaI.js";import{V as ue,a as M}from"./VRow-CFasNknx.js";import{V as H}from"./VSelect-BBvcpHuX.js";import{V as me}from"./VNavigationDrawer-RrJ7CuuC.js";import{V as pe}from"./VDataTableServer-dLSgHCq6.js";import"./index-C3NwvUM2.js";import"./index-9rIf2CJL.js";import"./VDialog-0i2MyK-R.js";import"./dialog-transition-B2pKVHb-.js";import"./helpers-DK5QwNv0.js";import"./VField-CvyOoNAD.js";import"./form-BsyuclTd.js";import"./VInput-DCf9aRQz.js";import"./VSpacer-BCVgdAwd.js";/* empty css              */import"./VAvatar-BgIHgX1n.js";import"./VImg-BWevH90G.js";import"./VTextField-DG88OKPn.js";/* empty css                   */import"./VCounter-zOsFyD3o.js";import"./VList-DjfFgeFe.js";import"./ssrBoot-BEJ69UV0.js";import"./VMenu-D_PRx64v.js";import"./VCheckboxBtn-CKjjSpr9.js";import"./VSelectionControl-BXoDVL8N.js";import"./VChip-BBE3Enfq.js";import"./VDataTable-CrfrFXcg.js";import"./VPagination-64W-UBzK.js";import"./VTable-Cb5v_Kut.js";import"./filter-Bi6u83zm.js";const ce={__name:"AddNewScheduleDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},item:{type:Object,default:()=>null},tienda_id:{type:Number,default:()=>null}},emits:["update:isDrawerOpen","refresh"],setup(N,{emit:T}){const n=N,u=X(),g=T,_=d({}),m=d({id:null,app_tienda_id:n.tienda_id,dia:null,start:"",end:""}),U=[{id:0,nombre:"Domingo"},{id:1,nombre:"Lunes"},{id:2,nombre:"Martes"},{id:3,nombre:"Miércoles"},{id:4,nombre:"Jueves"},{id:5,nombre:"Viernes"},{id:6,nombre:"Sábado"}],f=d(!1),c=d(),w=()=>{_.value={},g("update:isDrawerOpen",!1)},k=async()=>{try{_.value={};const t=await O(`/save-horario-by-tienda/${m.value.app_tienda_id}`,{method:"POST",body:m.value});u.success(`Horario ${m.value.id!=null?"actualizado":"creado"} con éxito`),g("refresh",t),g("update:isDrawerOpen",!1)}catch(t){u.error("Algo ha salido mal"),t.status==422&&(_.value=t.response._data.errors)}},b=async()=>{var p;const{valid:t,errors:i}=await((p=c.value)==null?void 0:p.validate());t&&await k()},v=()=>{ee(()=>{var t,i;(t=c.value)==null||t.reset(),(i=c.value)==null||i.resetValidation()}),m.value={id:null,app_tienda_id:n.tienda_id,dia:null,start:"",end:""}};A([()=>n.item,()=>n.tienda_id],([t,i])=>{t!=null?m.value=JSON.parse(JSON.stringify(t)):(v(),m.value.app_tienda_id=i)},{immediate:!0});const D=t=>{g("update:isDrawerOpen",t)};return(t,i)=>{const p=se,B=re;return E(),Y(me,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":n.isDrawerOpen,"onUpdate:modelValue":D},{default:r(()=>[a(p,{title:n.item!=null?"Editar horario de la tienda":"Agregar horario de la tienda",onCancel:w},null,8,["title"]),a(I),a(e(ne),{options:{wheelPropagation:!1}},{default:r(()=>[a(J,{flat:""},{default:r(()=>[a(z,null,{default:r(()=>[a(de,{ref_key:"refForm",ref:c,modelValue:e(f),"onUpdate:modelValue":i[3]||(i[3]=V=>y(f)?f.value=V:null),onSubmit:Z(b,["prevent"])},{default:r(()=>[a(ue,null,{default:r(()=>[a(M,{cols:"12"},{default:r(()=>[a(H,{modelValue:e(m).dia,"onUpdate:modelValue":i[0]||(i[0]=V=>e(m).dia=V),rules:["requiredValidator"in t?t.requiredValidator:e(P)],items:U,"item-title":"nombre","item-value":"id",label:"Día de la semana",placeholder:"Día de la semana"},null,8,["modelValue","rules"])]),_:1}),a(M,{cols:"12"},{default:r(()=>[a(B,{modelValue:e(m).start,"onUpdate:modelValue":i[1]||(i[1]=V=>e(m).start=V),label:"Hora inicio",format:"HH:mm",rules:["requiredValidator"in t?t.requiredValidator:e(P)],config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i",time_24hr:!0}},null,8,["modelValue","rules"])]),_:1}),a(M,{cols:"12"},{default:r(()=>[a(B,{modelValue:e(m).end,"onUpdate:modelValue":i[2]||(i[2]=V=>e(m).end=V),label:"Hora fin",format:"HH:mm",rules:["requiredValidator"in t?t.requiredValidator:e(P)],config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i",time_24hr:!0}},null,8,["modelValue","rules"])]),_:1}),a(M,{cols:"12"},{default:r(()=>[a(C,{type:"submit",class:"me-4"},{default:r(()=>i[4]||(i[4]=[S(" Aceptar ")])),_:1}),a(C,{type:"reset",variant:"outlined",color:"error",onClick:w},{default:r(()=>i[5]||(i[5]=[S(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},fe={class:"app-user-search-filter d-flex align-center"},ve={class:"d-flex justify-end flex-wrap gap-x-6 px-2 py-1"},Ve={class:"d-flex align-center gap-x-2 text-medium-emphasis text-base"},ge={class:"d-flex align-center text-base text-high-emphasis me-2 mb-0"},be={class:"d-flex gap-x-2 align-center me-2"},ra={__name:"index",setup(N){const T=d(""),n=d(10),u=d(1),g=d(),_=d(),m=o=>{var l,h;u.value=o.page,g.value=(l=o.sortBy[0])==null?void 0:l.key,_.value=(h=o.sortBy[0])==null?void 0:h.order},U=[{title:"Día",key:"dia"},{title:"Inicio",key:"start",sortable:!1},{title:"Fin",key:"end",sortable:!1},{title:"Acciones",key:"actions",sortable:!1}],f=d(!1),c=d(!1),w=d("success"),k=d(""),b=d(!1),v=d(null),D=d([]),t=d(0),i=d([]),p=d(null),B={0:"Domingo",1:"Lunes",2:"Martes",3:"Miércoles",4:"Jueves",5:"Viernes",6:"Sábado"},V=async()=>{try{const o=await O("/gettiendas",{method:"GET"});i.value=o,i.value.length>0&&(p.value=i.value[0].id)}catch(o){console.error(o)}},q=async()=>{try{const o=await O(`/get-horario-by-tienda/${p.value}`,{method:"GET",params:{search:T.value,itemsPerPage:n.value,page:u.value,sortBy:g.value,orderBy:_.value}});D.value=o.data,t.value=o.total}catch(o){console.error(o)}},G=async()=>{try{const o=await O(`/delete-horario-by-tienda/${v.value.id}`,{method:"GET"});let l=D.value.findIndex(h=>h.id==v.value.id);l>-1&&D.value.splice(l,1),f.value=!1,w.value="success",k.value=o.message,c.value=!0}catch(o){w.value="error",k.value=o.response._data.message,c.value=!0}},R=()=>{b.value=!0,v.value=null},j=o=>{b.value=!0,v.value=o},L=o=>{v.value=o,f.value=!0};return ae(V),A([n,g,_,u,p],()=>{q()}),A(b,async o=>{o||(v.value={})}),(o,l)=>{const h=oe("IconBtn"),Q=ie;return E(),te("section",null,[a(J,{title:"Filtros",class:"mb-6"},{default:r(()=>[a(z,{class:"d-flex"},{default:r(()=>[x("div",fe,[a(H,{modelValue:e(p),"onUpdate:modelValue":l[0]||(l[0]=s=>y(p)?p.value=s:null),density:"compact",label:"Tienda",placeholder:"Selecciona una una tienda",items:e(i),"item-title":"nombre","item-value":"id",class:"me-4"},null,8,["modelValue","items"]),a(C,{onClick:R},{default:r(()=>l[9]||(l[9]=[S(" Agregar nuevo horario ")])),_:1})])]),_:1}),a(pe,{"items-per-page":e(n),"onUpdate:itemsPerPage":l[4]||(l[4]=s=>y(n)?n.value=s:null),page:e(u),"onUpdate:page":l[5]||(l[5]=s=>y(u)?u.value=s:null),items:e(D),"item-value":"id","items-length":e(t),headers:U,class:"text-no-wrap rounded-0","onUpdate:options":m},{"item.dia":r(({item:s})=>[S($(B[s.dia]),1)]),"item.actions":r(({item:s})=>[a(h,{size:"small",onClick:K=>L(s)},{default:r(()=>[a(F,{icon:"ri-delete-bin-7-line"})]),_:2},1032,["onClick"]),a(h,{size:"small",onClick:K=>j(s)},{default:r(()=>[a(F,{icon:"ri-edit-box-line",title:"Editar"})]),_:2},1032,["onClick"])]),bottom:r(()=>[a(I),x("div",ve,[x("div",Ve,[l[10]||(l[10]=S(" Filas por página: ")),a(H,{modelValue:e(n),"onUpdate:modelValue":l[1]||(l[1]=s=>y(n)?n.value=s:null),class:"per-page-select",variant:"plain",items:[10,20,25,50,100]},null,8,["modelValue"])]),x("p",ge,$(("paginationMeta"in o?o.paginationMeta:e(W))({page:e(u),itemsPerPage:e(n)},e(t))),1),x("div",be,[a(C,{class:"flip-in-rtl",icon:"ri-arrow-left-s-line",variant:"text",density:"comfortable",color:"high-emphasis",disabled:e(u)<=1,onClick:l[2]||(l[2]=s=>e(u)<=1?u.value=1:u.value--)},null,8,["disabled"]),a(C,{class:"flip-in-rtl",icon:"ri-arrow-right-s-line",density:"comfortable",variant:"text",color:"high-emphasis",disabled:e(u)>=Math.ceil(e(t)/e(n)),onClick:l[3]||(l[3]=s=>e(u)>=Math.ceil(e(t)/e(n))?u.value=Math.ceil(e(t)/e(n)):u.value++)},null,8,["disabled"])])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),a(ce,{isDrawerOpen:e(b),"onUpdate:isDrawerOpen":l[6]||(l[6]=s=>y(b)?b.value=s:null),item:e(v),tienda_id:e(p),onRefresh:q},null,8,["isDrawerOpen","item","tienda_id"]),a(Q,{isDialogVisible:e(f),"onUpdate:isDialogVisible":l[7]||(l[7]=s=>y(f)?f.value=s:null),confirmationQuestion:"¿Está seguro que desea eliminar el horario seleccionado?",onConfirm:G},null,8,["isDialogVisible"]),a(le,{location:"top end",modelValue:e(c),"onUpdate:modelValue":l[8]||(l[8]=s=>y(c)?c.value=s:null),color:e(w)},{default:r(()=>[S($(e(k)),1)]),_:1},8,["modelValue","color"])])}}};export{ra as default};
