import{a as se}from"./formatters-zPA0pF4b.js";import{_ as te}from"./UserInfoEditDialog-jUe_9M1V.js";import{r as n,B as G,o as w,c as O,b as e,e as a,aM as A,n as s,v as x,x as D,f as $,d as y,af as L,z as q,ag as C,F as J,j as M,I as R,a as le,ar as oe,a0 as K,am as re,ak as ne,i as ue}from"./main-DXTHM_Z4.js";import{$ as F}from"./api-CWHLgCqw.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as V,V as S}from"./VRow-U9BCKMf6.js";import{V as N,b as ie}from"./VCard-BBjecQUS.js";import{V as I}from"./VCardText-DGP4d7zZ.js";import{V as me}from"./VAvatar-QubjHI1z.js";import{V as pe}from"./VImg-DTTLi8N3.js";import{V as ce}from"./VChip-CoWdbaPm.js";import{V as Q}from"./VDivider-CVdsTcIK.js";import{V as fe,a as P,b as E}from"./VList-5epMYaPo.js";import{_ as Ve}from"./AppDateTimePicker-Co0_bleo.js";import{_ as ve}from"./DeleteDialog-BWKI8zwF.js";import{e as be}from"./es-B-Pf7tX4.js";import{V as _e}from"./VDataTable-Dhru72M2.js";import{p as W,c as ge}from"./validators-CrSGMxiT.js";import{V as ye,a as De}from"./VAlert-ymSxCZ52.js";import{V as Ue}from"./VForm-B4Tyf17S.js";import{V as T}from"./VTextField-BfMLnCIA.js";import{V as we,a as xe}from"./VTabs-Cs01WiBI.js";import{V as ke,a as H}from"./VWindowItem-Ccc_dZvZ.js";import"./helpers-DK5QwNv0.js";import"./DialogCloseBtn-vF1tbmc_.js";import"./VSelect-DDGWU2xG.js";import"./form-ijrz4ipO.js";import"./dialog-transition-CqXIoDZd.js";import"./VMenu-D1AAVsYt.js";import"./VCheckboxBtn-DNkfUJpf.js";import"./VSelectionControl-DqCfd3An.js";import"./VDialog-BXZSKyZJ.js";import"./index-D1tqMycq.js";import"./index-9rIf2CJL.js";/* empty css              */import"./ssrBoot-BzQpit4r.js";import"./VField-B2YWi8oL.js";import"./VInput-BZH6jw62.js";import"./VPagination-EsQETAJ-.js";import"./VTable-DROJbQhe.js";import"./filter-B81R-Kvh.js";/* empty css                   */import"./VCounter-CfjE-LQa.js";import"./VSlideGroup-C1X9mQaT.js";const Ce={key:1,class:"text-5xl font-weight-medium"},Te={class:"text-h5 mt-4"},Se={class:"text-body-1"},$e={class:"text-body-1"},Fe={class:"text-body-1"},Ie={class:"text-body-1"},Be={class:"text-body-1"},Pe={__name:"UserBioPanel",props:{userData:{type:Object,required:!0}},emits:["update:userData"],setup(B,{emit:c}){const o=B,p=n({status:!1,color:"success",message:""}),i=G("userData"),_=c,l=n(!1),v=async m=>{try{const t=await F("/save-usuario",{method:"POST",body:m.value});p.value={color:"success",status:!0,message:"Usuario actualizado con éxito"},_("update:userData",m)}catch{p.value={color:"error",status:!0,message:"error guardando usuario"}}};return(m,t)=>{const r=te;return w(),O(J,null,[e(S,null,{default:a(()=>[e(A,{modelValue:s(p).status,"onUpdate:modelValue":t[0]||(t[0]=u=>s(p).status=u),location:"top end",color:s(p).color},{default:a(()=>[x(D(s(p).message),1)]),_:1},8,["modelValue","color"]),e(V,{cols:"12"},{default:a(()=>[o.userData?(w(),$(N,{key:0},{default:a(()=>[e(I,{class:"text-center pt-12 pb-6"},{default:a(()=>[e(me,{rounded:"",size:120,color:o.userData.avatar?void 0:"primary",variant:o.userData.avatar?void 0:"tonal"},{default:a(()=>[o.userData.avatar?(w(),$(pe,{key:0,src:o.userData.avatar},null,8,["src"])):(w(),O("span",Ce,D(("avatarText"in m?m.avatarText:s(se))(o.userData.name)),1))]),_:1},8,["color","variant"]),y("h5",Te,D(o.userData.name),1),e(ce,{size:"small",class:"text-capitalize mt-4"},{default:a(()=>[x(D(o.userData.rol),1)]),_:1})]),_:1}),e(I,{class:"pb-6"},{default:a(()=>[t[8]||(t[8]=y("h5",{class:"text-h5"}," Detalles ",-1)),e(Q,{class:"my-4"}),e(fe,{class:"card-list"},{default:a(()=>[e(P,null,{default:a(()=>[e(E,{class:"text-sm"},{default:a(()=>[t[3]||(t[3]=y("span",{class:"font-weight-medium"},"Nombre: ",-1)),y("span",Se,D(o.userData.name),1)]),_:1})]),_:1}),e(P,null,{default:a(()=>[e(E,{class:"text-sm"},{default:a(()=>[t[4]||(t[4]=y("span",{class:"font-weight-medium"}," Email: ",-1)),y("span",$e,D(o.userData.email),1)]),_:1})]),_:1}),e(P,null,{default:a(()=>[e(E,{class:"text-sm"},{default:a(()=>[t[5]||(t[5]=y("span",{class:"font-weight-medium"}," NIF: ",-1)),y("span",Fe,D(o.userData.nif),1)]),_:1})]),_:1}),e(P,null,{default:a(()=>[e(E,{class:"text-sm"},{default:a(()=>[t[6]||(t[6]=y("span",{class:"font-weight-medium"}," NAF: ",-1)),y("span",Ie,D(o.userData.naf),1)]),_:1})]),_:1}),e(P,null,{default:a(()=>[e(E,{class:"text-sm"},{default:a(()=>[t[7]||(t[7]=y("span",{class:"font-weight-medium"}," Empresa: ",-1)),y("span",Be,D(o.userData.empresa),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(I,{class:"d-flex justify-center"},{default:a(()=>[s(i).id_role==1||s(i).id_role==2?(w(),$(L,{key:0,variant:"elevated",class:"me-4",onClick:t[1]||(t[1]=u=>l.value=!0)},{default:a(()=>t[9]||(t[9]=[x(" Editar ")])),_:1})):q("",!0)]),_:1})]),_:1})):q("",!0)]),_:1})]),_:1}),e(r,{isDialogVisible:s(l),"onUpdate:isDialogVisible":t[2]||(t[2]=u=>C(l)?l.value=u:null),"user-data":o.userData,onSubmit:v},null,8,["isDialogVisible","user-data"])],64)}}},Ee=de(Pe,[["__scopeId","data-v-da15e5b0"]]),Ae={class:"text-center"},Ne={__name:"UserTabOverview",setup(B){const c=n({status:!1,color:"success",message:""}),o=n(8),p=n(1),i=n(),_=n(),l=n(!1),v=g=>{var b,z;p.value=g.page,i.value=(b=g.sortBy[0])==null?void 0:b.key,_.value=(z=g.sortBy[0])==null?void 0:z.order},m=M(),t=[{title:"Fecha",key:"fecha"},{title:"Acciones",key:"actions"}],r=n(""),u=n(new Date().getFullYear()),U=n([]),d=n({}),f=async()=>{try{const g=await F("/get-vacaciones",{method:"GET",params:{id_usuario:m.params.id,year:u.value}});U.value=g.data}catch(g){console.error(g)}},j=async()=>{const g=r.value.split(",");await F("/save-vacaciones",{method:"POST",body:{vacaciones:g,id_usuario:m.params.id}}),c.value={color:"success",status:!0,message:"Fecha guardada con éxito"},f()},X=g=>{d.value=g,l.value=!0},Z=async g=>{try{await F(`/delete-vacaciones/${g}`,{method:"GET"}),c.value={color:"success",status:!0,message:"Fecha eliminada con éxito"}}catch{c.value={color:"success",status:!0,message:"Error eliminando fecha"}}f()};R(f);const h=G("userData");return(g,b)=>{const z=ve,ee=Ve,ae=le("IconBtn");return w(),$(S,null,{default:a(()=>{var Y;return[e(z,{isDialogVisible:s(l),"onUpdate:isDialogVisible":b[0]||(b[0]=k=>C(l)?l.value=k:null),id:(Y=s(d))==null?void 0:Y.id,onSubmit:Z},null,8,["isDialogVisible","id"]),e(A,{modelValue:s(c).status,"onUpdate:modelValue":b[1]||(b[1]=k=>s(c).status=k),location:"top end",color:s(c).color},{default:a(()=>[x(D(s(c).message),1)]),_:1},8,["modelValue","color"]),e(V,{cols:"12"},{default:a(()=>[e(N,{title:"Agregar vacaciones"},{default:a(()=>[e(I,null,{default:a(()=>[e(S,null,{default:a(()=>[e(V,{cols:"12",md:"6"},{default:a(()=>[e(ee,{modelValue:s(r),"onUpdate:modelValue":b[2]||(b[2]=k=>C(r)?r.value=k:null),label:"Fecha",placeholder:"Selecciona una o mas fechas",config:{mode:"multiple",dateFormat:"Y-m-d",altFormat:"d-m-Y",altInput:!0,locale:s(be.Spanish)}},null,8,["modelValue","config"])]),_:1}),e(V,{cols:"12",md:"2"},{default:a(()=>[e(L,{onClick:j},{default:a(()=>b[5]||(b[5]=[x("Añadir")])),_:1})]),_:1})]),_:1})]),_:1}),e(Q),y("h3",Ae,D(s(u)),1),e(I,null,{default:a(()=>[e(_e,{search:g.search,headers:t,items:s(U),"item-value":"id",class:"text-no-wrap rounded-0","items-per-page":s(o),"onUpdate:itemsPerPage":b[3]||(b[3]=k=>C(o)?o.value=k:null),page:s(p),"onUpdate:page":b[4]||(b[4]=k=>C(p)?p.value=k:null),"onUpdate:options":v},oe({_:2},[s(h).id_role!=3?{name:"item.actions",fn:a(({item:k})=>[e(ae,{size:"small",onClick:Oe=>X(k)},{default:a(()=>[e(K,{icon:"ri-delete-bin-7-line"})]),_:2},1032,["onClick"])]),key:"0"}:void 0]),1032,["search","items","items-per-page","page"])]),_:1})]),_:1})]),_:1})]}),_:1})}}},je={__name:"UserTabSecurity",setup(B){const c=M(),o=n({status:!1,color:"success",message:""}),p=n(!1),i=n(!1),_=n(!1),l=n(""),v=n(""),m=n(!1),t=n(),r=n(""),u=()=>{var U;(U=t.value)==null||U.validate().then(({valid:d})=>{d&&(F("/change-password",{method:"POST",body:{userId:c.params.id,password:l.value}}).then(f=>{_.value=!0,r.value=f.success,o.value={color:"success",status:!0,message:"Contraseña actualizada con éxito"}}),ne(()=>{var f,j;(f=t.value)==null||f.reset(),(j=t.value)==null||j.resetValidation()}))})};return(U,d)=>(w(),O(J,null,[e(S,null,{default:a(()=>[e(A,{modelValue:s(o).status,"onUpdate:modelValue":d[0]||(d[0]=f=>s(o).status=f),location:"top end",color:s(o).color},{default:a(()=>[x(D(s(o).message),1)]),_:1},8,["modelValue","color"]),e(V,{cols:"12"},{default:a(()=>[e(N,{title:"Cambiar Contraseña"},{default:a(()=>[e(I,null,{default:a(()=>[e(ye,{variant:"tonal",color:"warning",closable:"",class:"mb-6"},{default:a(()=>[e(De,null,{default:a(()=>d[7]||(d[7]=[x("Asegurese de que estos requerimientos se cumplan")])),_:1}),d[8]||(d[8]=y("span",null,"Mínimo 8 caracteres, mayúscula y símbolos",-1))]),_:1}),e(Ue,{ref_key:"refForm",ref:t,modelValue:s(m),"onUpdate:modelValue":d[5]||(d[5]=f=>C(m)?m.value=f:null),onSubmit:re(u,["prevent"])},{default:a(()=>[e(S,null,{default:a(()=>[e(V,{cols:"12",md:"6"},{default:a(()=>[e(T,{modelValue:s(l),"onUpdate:modelValue":d[1]||(d[1]=f=>C(l)?l.value=f:null),label:"Nueva Contraseña",placeholder:"············",type:s(p)?"text":"password","append-inner-icon":s(p)?"ri-eye-off-line":"ri-eye-line","onClick:appendInner":d[2]||(d[2]=f=>p.value=!s(p)),rules:["passwordValidator"in U?U.passwordValidator:s(W)]},null,8,["modelValue","type","append-inner-icon","rules"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(T,{modelValue:s(v),"onUpdate:modelValue":d[3]||(d[3]=f=>C(v)?v.value=f:null),label:"Confirmar Contraseña",placeholder:"············",type:s(i)?"text":"password","append-inner-icon":s(i)?"ri-eye-off-line":"ri-eye-line","onClick:appendInner":d[4]||(d[4]=f=>i.value=!s(i)),rules:["passwordValidator"in U?U.passwordValidator:s(W),("confirmedValidator"in U?U.confirmedValidator:s(ge))(s(v),s(l))]},null,8,["modelValue","type","append-inner-icon","rules"])]),_:1}),e(V,{cols:"12"},{default:a(()=>[e(L,{type:"submit"},{default:a(()=>d[9]||(d[9]=[x(" Cambiar Contraseña ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(A,{modelValue:s(_),"onUpdate:modelValue":d[6]||(d[6]=f=>C(_)?_.value=f:null),location:"top end",color:"success"},{default:a(()=>[x(D(s(r)),1)]),_:1},8,["modelValue"])],64))}},ze={__name:"UserSchedule",setup(B){const c=n({status:!1,color:"success",message:"Horario guardado con exito"}),p=M().params.id,i=n(!0),_=G("userData");_.value.id_role!=3&&(i.value=!1);const l=n({id:null,usuario_id:null,domingo:0,lunes:0,martes:0,miercoles:0,jueves:0,viernes:0,sabado:0}),v=async()=>{try{const t=await F(`/get-jornada/${p}`,{method:"GET"});t.id&&(l.value=t)}catch(t){console.error(t)}},m=async()=>{try{const t=await F(`/save-jornada/${p}`,{method:"POST",body:l.value});l.value=t,c.value={color:"success",status:!0,message:"Jornada guardada con exito"}}catch{c.value={color:"error",status:!0,message:"Error guardando horario"}}};return R(v),(t,r)=>(w(),$(S,null,{default:a(()=>[e(A,{modelValue:s(c).status,"onUpdate:modelValue":r[0]||(r[0]=u=>s(c).status=u),location:"top end",color:s(c).color},{default:a(()=>[x(D(s(c).message),1)]),_:1},8,["modelValue","color"]),e(V,{cols:"12"},{default:a(()=>[e(N,{title:"Jornada Laboral"},{default:a(()=>[e(I,null,{default:a(()=>[e(S,null,{default:a(()=>[e(V,{cols:"12",md:"4"},{default:a(()=>[e(T,{disabled:s(i),modelValue:s(l).lunes,"onUpdate:modelValue":r[1]||(r[1]=u=>s(l).lunes=u),label:"Lunes",type:"number",step:"0.1"},null,8,["disabled","modelValue"])]),_:1}),e(V,{cols:"12",md:"4"},{default:a(()=>[e(T,{disabled:s(i),modelValue:s(l).martes,"onUpdate:modelValue":r[2]||(r[2]=u=>s(l).martes=u),label:"Martes",type:"number",step:"0.1"},null,8,["disabled","modelValue"])]),_:1}),e(V,{cols:"12",md:"4"},{default:a(()=>[e(T,{disabled:s(i),modelValue:s(l).miercoles,"onUpdate:modelValue":r[3]||(r[3]=u=>s(l).miercoles=u),label:"Miércoles",type:"number",step:"0.1"},null,8,["disabled","modelValue"])]),_:1}),e(V,{cols:"12",md:"4"},{default:a(()=>[e(T,{disabled:s(i),modelValue:s(l).jueves,"onUpdate:modelValue":r[4]||(r[4]=u=>s(l).jueves=u),label:"Jueves",type:"number",step:"0.1"},null,8,["disabled","modelValue"])]),_:1}),e(V,{cols:"12",md:"4"},{default:a(()=>[e(T,{disabled:s(i),modelValue:s(l).viernes,"onUpdate:modelValue":r[5]||(r[5]=u=>s(l).viernes=u),label:"Viernes",type:"number",step:"0.1"},null,8,["disabled","modelValue"])]),_:1}),e(V,{cols:"12",md:"4"},{default:a(()=>[e(T,{disabled:s(i),modelValue:s(l).sabado,"onUpdate:modelValue":r[6]||(r[6]=u=>s(l).sabado=u),label:"Sábado",type:"number",step:"0.1"},null,8,["disabled","modelValue"])]),_:1}),e(V,{cols:"12",md:"4"},{default:a(()=>[e(T,{disabled:s(i),modelValue:s(l).domingo,"onUpdate:modelValue":r[7]||(r[7]=u=>s(l).domingo=u),label:"Domingo",type:"number",step:"0.1"},null,8,["disabled","modelValue"])]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(V,{cols:"12",md:"4"},{default:a(()=>[s(_).id_role==1||s(_).id_role==2?(w(),$(L,{key:0,onClick:m,class:"me-2"},{default:a(()=>r[8]||(r[8]=[x(" guardar ")])),_:1})):q("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}},Fa={__name:"[id]",setup(B){const c=M(),o=n(null),p=[{icon:"ri-calendar-event-line",title:"Vacaciones"},{icon:"ri-lock-2-line",title:"Seguridad"}],i=n({}),_=async()=>{i.value=await F(`/getusuario/${c.params.id}`)};return R(_),(l,v)=>s(i)?(w(),$(S,{key:0},{default:a(()=>[e(V,{cols:"12",md:"5",lg:"4"},{default:a(()=>[e(Ee,{"user-data":s(i),"onUpdate:userData":_},null,8,["user-data"])]),_:1}),e(V,{cols:"12",md:"7",lg:"8"},{default:a(()=>[e(we,{modelValue:s(o),"onUpdate:modelValue":v[0]||(v[0]=m=>C(o)?o.value=m:null),class:"v-tabs-pill"},{default:a(()=>[(w(),O(J,null,ue(p,m=>e(xe,{key:m.icon},{default:a(()=>[e(K,{start:"",icon:m.icon},null,8,["icon"]),y("span",null,D(m.title),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(ke,{modelValue:s(o),"onUpdate:modelValue":v[1]||(v[1]=m=>C(o)?o.value=m:null),class:"mt-6 disable-tab-transition",touch:!1},{default:a(()=>[e(H,null,{default:a(()=>[e(Ne),e(ze)]),_:1}),e(H,null,{default:a(()=>[e(je)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(w(),$(N,{key:1},{default:a(()=>[e(ie,{class:"text-center"},{default:a(()=>v[2]||(v[2]=[x(" Usuario no encontrado ")])),_:1})]),_:1}))}};export{Fa as default};
