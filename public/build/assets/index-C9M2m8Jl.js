import{p as H}from"./paginationMeta-BbY5dJ0C.js";import{_ as Y}from"./ConfirmDialog-BcB1qS-q.js";import{aT as F,r as m,w as I,o as A,f as K,e as s,b as l,n as e,ag as w,am as L,d as P,af as B,v as O,ak as W,I as X,c as Z,aM as ee,a0 as T,x as q,a as le}from"./main-BwDGDDDW.js";import{r as $,e as ae}from"./validators-CrSGMxiT.js";import{_ as oe}from"./AppDateTimePicker-BgncYox4.js";import{_ as te}from"./AppDrawerHeaderSection-Dm2jDqJm.js";import{P as re}from"./vue3-perfect-scrollbar.esm-BA1GFVP8.js";import{$ as se,a as N}from"./api-CjWrXaZL.js";import{V as z}from"./VDivider-PVfbuN4-.js";import{V as j}from"./VCard-Cpw0jw9u.js";import{V as G}from"./VCardText-BKkdmkn-.js";import{V as ie}from"./VForm-DbaU_ACV.js";import{V as ne,a as _}from"./VRow-DJH2tZVu.js";import{V as S}from"./VTextField-DqZOZREA.js";import{V as me}from"./VColorPicker-CqOnoaUc.js";import{V as de}from"./VNavigationDrawer-DiCpI_FT.js";import{V as ue}from"./VDataTableServer-BLeqennM.js";import{V as pe}from"./VSelect-Cdsnm3mB.js";import"./VDialog-5yhkawgU.js";import"./dialog-transition-GiYjLY5n.js";import"./helpers-DK5QwNv0.js";import"./VField-5sqsN37e.js";import"./form-BEvPHhJ7.js";import"./VInput-CVFVwJKu.js";import"./VSpacer-xWNtBUsj.js";/* empty css              */import"./VAvatar-DYn3is-W.js";import"./VImg-BYy41-F9.js";import"./index-D8byVCHt.js";import"./index-9rIf2CJL.js";/* empty css                   */import"./VCounter-IA5S7b1U.js";import"./VSlider-BkxdWNYY.js";import"./VSliderTrack-BM72krPj.js";import"./VSheet-DG-Sct6I.js";import"./ssrBoot-B7QpyNAy.js";import"./VDataTable-B4BcEe_U.js";import"./VPagination-DIhj3juL.js";import"./VCheckboxBtn-CuvLREeJ.js";import"./VSelectionControl-D0_t5DTC.js";import"./VTable-CK8MMDdB.js";import"./filter-B9tzeaPh.js";import"./VList-CLtMWoGj.js";import"./VMenu-BWP2lKbi.js";import"./VChip-CXCzEWTC.js";const ce={__name:"EmployeeDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},item:{type:Object,default:()=>null}},emits:["update:isDrawerOpen","itemData"],setup(M,{emit:D}){const d=M,n=F(),b=D,c=m({}),u=m({id:null,tipo_id:1,nombre:null,email:null,telefono:null,color:null,tipo_libre:"V",lista_vacaciones:[],lista_libres:[]}),U=m(!1),f=m();m();const V=()=>{c.value={},b("update:isDrawerOpen",!1)},g=async()=>{try{c.value={};const a=await se("/api/app/saveempleado",{method:"POST",body:u.value});console.log(a),n.success("Empleado guardado con éxito"),b("itemData",a),b("update:isDrawerOpen",!1)}catch(a){n.error("Algo ha salido mal"),a.status==422&&(c.value=a.response._data.errors)}},y=async()=>{var C;const{valid:a,errors:t}=await((C=f.value)==null?void 0:C.validate());a&&await g()},k=()=>{W(()=>{var a,t;(a=f.value)==null||a.reset(),(t=f.value)==null||t.resetValidation()}),u.value={id:null,tipo_id:1,nombre:null,email:null,telefono:null,color:null,tipo_libre:"V",lista_vacaciones:null,lista_libres:null}};I(()=>{var a;((a=d.item)==null?void 0:a.id)!=null?u.value=JSON.parse(JSON.stringify(d.item)):k()});const x=a=>{b("update:isDrawerOpen",a)};return(a,t)=>{const C=te,E=oe;return A(),K(de,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":d.isDrawerOpen,"onUpdate:modelValue":x},{default:s(()=>[l(C,{title:d.item!=null?"Editar Empleado":"Agregar Empleado",onCancel:V},null,8,["title"]),l(z),l(e(re),{options:{wheelPropagation:!1}},{default:s(()=>[l(j,{flat:""},{default:s(()=>[l(G,null,{default:s(()=>[l(ie,{ref_key:"refForm",ref:f,modelValue:e(U),"onUpdate:modelValue":t[6]||(t[6]=p=>w(U)?U.value=p:null),onSubmit:L(y,["prevent"])},{default:s(()=>[l(ne,null,{default:s(()=>[l(_,{cols:"12"},{default:s(()=>[l(S,{modelValue:e(u).nombre,"onUpdate:modelValue":t[0]||(t[0]=p=>e(u).nombre=p),rules:["requiredValidator"in a?a.requiredValidator:e($)],label:"Nombre",placeholder:"","error-messages":e(c).nombre?e(c).nombre[0]:""},null,8,["modelValue","rules","error-messages"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(S,{modelValue:e(u).email,"onUpdate:modelValue":t[1]||(t[1]=p=>e(u).email=p),rules:["requiredValidator"in a?a.requiredValidator:e($),"emailValidator"in a?a.emailValidator:e(ae)],label:"Email",placeholder:"","error-messages":e(c).email?e(c).email[0]:""},null,8,["modelValue","rules","error-messages"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(S,{modelValue:e(u).telefono,"onUpdate:modelValue":t[2]||(t[2]=p=>e(u).telefono=p),rules:["requiredValidator"in a?a.requiredValidator:e($)],label:"Teléfono",placeholder:"","error-messages":e(c).telefono?e(c).telefono[0]:""},null,8,["modelValue","rules","error-messages"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(E,{modelValue:e(u).lista_vacaciones,"onUpdate:modelValue":t[3]||(t[3]=p=>e(u).lista_vacaciones=p),label:"Vacaciones",placeholder:"Selecciona una o más fechas",config:{mode:"multiple",dateFormat:"Y-m-d"}},null,8,["modelValue"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[t[7]||(t[7]=P("p",{class:"ml-2"},"Color del empleado",-1)),l(me,{modelValue:e(u).color,"onUpdate:modelValue":[t[4]||(t[4]=p=>e(u).color=p),t[5]||(t[5]=p=>a.setPrimaryColor({main:a.customPrimaryColor,darken:a.customPrimaryColor}))],mode:"hex",modes:["hex"]},null,8,["modelValue"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(B,{type:"submit",class:"me-4"},{default:s(()=>t[8]||(t[8]=[O(" Aceptar ")])),_:1}),l(B,{type:"reset",variant:"outlined",color:"error",onClick:V},{default:s(()=>t[9]||(t[9]=[O(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},fe={class:"app-user-search-filter d-flex align-center"},ve={class:"d-flex justify-end flex-wrap gap-x-6 px-2 py-1"},Ve={class:"d-flex align-center gap-x-2 text-medium-emphasis text-base"},ge={class:"d-flex align-center text-base text-high-emphasis me-2 mb-0"},be={class:"d-flex gap-x-2 align-center me-2"},dl={__name:"index",setup(M){F();const D=m(""),d=m(10),n=m(1),b=m(),c=m(),u=r=>{var o,v;n.value=r.page,b.value=(o=r.sortBy[0])==null?void 0:o.key,c.value=(v=r.sortBy[0])==null?void 0:v.order},U=[{title:"Nombre",key:"nombre"},{title:"Email",key:"email"},{title:"Teléfono",key:"telefono"},{title:"Acciones",key:"actions",sortable:!1}],f=m(!1),V=m(null),g=m([]),y=m(0),k=m(!1),x=m(!1),a=m("success"),t=m(""),C=async()=>{try{const r=await N("/getempleados",{method:"GET",params:{search:D.value,itemsPerPage:d.value,page:n.value,sortBy:b.value,orderBy:c.value}});g.value=r.data,y.value=r.total}catch(r){console.error(r)}},E=r=>{console.log(r);let o=g.value.findIndex(v=>v.id==r.id);if(o>-1)return g.value[o]=r;g.value.unshift(r)},p=async()=>{try{const r=await N(`/deleteempleado/${V.value.id}`,{method:"GET"});let o=g.value.findIndex(v=>v.id==V.value.id);o>-1&&g.value.splice(o,1),k.value=!1,a.value="success",t.value=r.message,x.value=!0}catch(r){a.value="error",t.value=r.response._data.message,x.value=!0}},h=r=>{f.value=!0,V.value=r},J=r=>{V.value=r,k.value=!0};return X(C),I([d,b,c,n,D],()=>{C()}),I(f,async r=>{r||(V.value={})}),(r,o)=>{const v=le("IconBtn"),Q=Y;return A(),Z("section",null,[l(j,{title:"Filtros",class:"mb-6"},{default:s(()=>[l(G,{class:"d-flex flex-wrap gap-4"},{default:s(()=>[P("div",fe,[l(S,{modelValue:e(D),"onUpdate:modelValue":o[0]||(o[0]=i=>w(D)?D.value=i:null),placeholder:"Buscar",density:"compact",class:"me-4"},null,8,["modelValue"]),l(B,{onClick:h},{default:s(()=>o[9]||(o[9]=[O(" Agregar nuevo empleado ")])),_:1})])]),_:1}),l(ue,{"items-per-page":e(d),"onUpdate:itemsPerPage":o[4]||(o[4]=i=>w(d)?d.value=i:null),page:e(n),"onUpdate:page":o[5]||(o[5]=i=>w(n)?n.value=i:null),items:e(g),"item-value":"id","items-length":e(y),headers:U,class:"text-no-wrap rounded-0","onUpdate:options":u},{"item.actions":s(({item:i})=>[l(v,{size:"small",onClick:R=>J(i)},{default:s(()=>[l(T,{icon:"ri-delete-bin-7-line"})]),_:2},1032,["onClick"]),l(v,{size:"small",onClick:R=>h(i)},{default:s(()=>[l(T,{icon:"ri-edit-box-line",title:"Editar"})]),_:2},1032,["onClick"]),l(v,{size:"small",to:{name:"apps-employee-view-id",params:{id:i.id}}},{default:s(()=>[l(T,{icon:"ri-eye-line"})]),_:2},1032,["to"])]),bottom:s(()=>[l(z),P("div",ve,[P("div",Ve,[o[10]||(o[10]=O(" Filas por página: ")),l(pe,{modelValue:e(d),"onUpdate:modelValue":o[1]||(o[1]=i=>w(d)?d.value=i:null),class:"per-page-select",variant:"plain",items:[10,20,25,50,100]},null,8,["modelValue"])]),P("p",ge,q(("paginationMeta"in r?r.paginationMeta:e(H))({page:e(n),itemsPerPage:e(d)},e(y))),1),P("div",be,[l(B,{class:"flip-in-rtl",icon:"ri-arrow-left-s-line",variant:"text",density:"comfortable",color:"high-emphasis",disabled:e(n)<=1,onClick:o[2]||(o[2]=i=>e(n)<=1?n.value=1:n.value--)},null,8,["disabled"]),l(B,{class:"flip-in-rtl",icon:"ri-arrow-right-s-line",density:"comfortable",variant:"text",color:"high-emphasis",disabled:e(n)>=Math.ceil(e(y)/e(d)),onClick:o[3]||(o[3]=i=>e(n)>=Math.ceil(e(y)/e(d))?n.value=Math.ceil(e(y)/e(d)):n.value++)},null,8,["disabled"])])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),l(ce,{isDrawerOpen:e(f),"onUpdate:isDrawerOpen":o[6]||(o[6]=i=>w(f)?f.value=i:null),item:e(V),onItemData:E},null,8,["isDrawerOpen","item"]),l(Q,{isDialogVisible:e(k),"onUpdate:isDialogVisible":o[7]||(o[7]=i=>w(k)?k.value=i:null),confirmationQuestion:"¿Está seguro que desea eliminar el empleado seleccionado?",onConfirm:p},null,8,["isDialogVisible"]),l(ee,{location:"top end",modelValue:e(x),"onUpdate:modelValue":o[8]||(o[8]=i=>w(x)?x.value=i:null),color:e(a)},{default:s(()=>[O(q(e(t)),1)]),_:1},8,["modelValue","color"])])}}};export{dl as default};
