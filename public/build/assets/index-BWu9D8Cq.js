import{a as T}from"./api-DoG2ksOD.js";import{p as K}from"./paginationMeta-BbY5dJ0C.js";import{aT as I,r as u,w as N,a6 as L,o as H,f as W,e as r,b as a,n as e,ag as g,am as X,af as P,v as M,ak as Y,I as Z,c as ee,aM as ae,d as h,a0 as A,x as E,a as le}from"./main-XhKa_9tU.js";import{_ as oe}from"./ConfirmDialog-CY-Jws0o.js";import{r as $}from"./validators-CrSGMxiT.js";import{_ as te}from"./AppDrawerHeaderSection-C-4ZcHAe.js";import{P as re}from"./vue3-perfect-scrollbar.esm-CvKV9PJx.js";import{h as F}from"./moment-C5S46NFB.js";import{V as z}from"./VDivider-C4lH0ooT.js";import{V as R}from"./VCard-Eaj0dfV-.js";import{V as j}from"./VCardText-B_O88IhU.js";import{V as ie}from"./VForm-BH9swDaI.js";import{V as se,a as B}from"./VRow-CFasNknx.js";import{V as O}from"./VTextField-DG88OKPn.js";import{V as ne}from"./VNavigationDrawer-RrJ7CuuC.js";import{V as ue}from"./VDataTableServer-dLSgHCq6.js";import{V as de}from"./VSelect-BBvcpHuX.js";import"./index-C3NwvUM2.js";import"./index-9rIf2CJL.js";import"./VDialog-0i2MyK-R.js";import"./dialog-transition-B2pKVHb-.js";import"./helpers-DK5QwNv0.js";import"./VSpacer-BCVgdAwd.js";/* empty css              */import"./VAvatar-BgIHgX1n.js";import"./VImg-BWevH90G.js";import"./form-BsyuclTd.js";/* empty css                   */import"./VCounter-zOsFyD3o.js";import"./VField-CvyOoNAD.js";import"./VInput-DCf9aRQz.js";import"./ssrBoot-BEJ69UV0.js";import"./VDataTable-CrfrFXcg.js";import"./VPagination-64W-UBzK.js";import"./VCheckboxBtn-CKjjSpr9.js";import"./VSelectionControl-BXoDVL8N.js";import"./VTable-Cb5v_Kut.js";import"./filter-Bi6u83zm.js";import"./VList-DjfFgeFe.js";import"./VMenu-D_PRx64v.js";import"./VChip-BBE3Enfq.js";const pe={__name:"AddNewServiceDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},item:{type:Object,default:()=>null}},emits:["update:isDrawerOpen","refresh"],setup(q,{emit:w}){const d=q,s=I(),b=w,D=u({}),p=u({id:null,nombre:"",precio:0,duracion:"",tipos:{tipo_pelo:[],tipo_mascota:[],tipo_tamanyo:[]}}),C=u(!1),c=u(),f=u(!1),x=()=>{D.value={},b("update:isDrawerOpen",!1)},U=async()=>{try{D.value={},p.value.tipos==null&&(p.value.tipos={tipo_pelo:[],tipo_mascota:[],tipo_tamanyo:[]});const o=await T("/saveservicio",{method:"POST",body:p.value});s.success(`Servicio ${p.value.id!=null?"actualizado":"creado"} con éxito`),b("refresh",o),b("update:isDrawerOpen",!1)}catch(o){s.error("Algo ha salido mal"),o.status==422&&(D.value=o.response._data.errors)}},y=async()=>{var k;const{valid:o,errors:i}=await((k=c.value)==null?void 0:k.validate());o&&await U()},V=()=>{Y(()=>{var o,i;(o=c.value)==null||o.reset(),(i=c.value)==null||i.resetValidation()}),p.value={id:null,nombre:"",precio:0,duracion:"",tipos:{tipo_pelo:[],tipo_mascota:[],tipo_tamanyo:[]}}};N(()=>{d.item!=null?p.value=JSON.parse(JSON.stringify(d.item)):V()}),N(()=>p.value.duracion,o=>{f.value=o%30===0,console.log("is_multiple",f.value)});const S=o=>{b("update:isDrawerOpen",o)},v=L(()=>p.value.duracion?F.utc(F.duration(p.value.duracion,"minutes").asMilliseconds()).format("HH:mm"):null);return(o,i)=>{const k=te;return H(),W(ne,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":d.isDrawerOpen,"onUpdate:modelValue":S},{default:r(()=>[a(k,{title:d.item!=null?"Editar servicio":"Agregar servicio",onCancel:x},null,8,["title"]),a(z),a(e(re),{options:{wheelPropagation:!1}},{default:r(()=>[a(R,{flat:""},{default:r(()=>[a(j,null,{default:r(()=>[a(ie,{ref_key:"refForm",ref:c,modelValue:e(C),"onUpdate:modelValue":i[4]||(i[4]=m=>g(C)?C.value=m:null),onSubmit:X(y,["prevent"])},{default:r(()=>[a(se,null,{default:r(()=>[a(B,{cols:"12"},{default:r(()=>[a(O,{modelValue:e(p).nombre,"onUpdate:modelValue":i[0]||(i[0]=m=>e(p).nombre=m),rules:["requiredValidator"in o?o.requiredValidator:e($)],label:"Nombre",placeholder:"Servicio"},null,8,["modelValue","rules"])]),_:1}),a(B,{cols:"12"},{default:r(()=>[a(O,{modelValue:e(p).precio,"onUpdate:modelValue":i[1]||(i[1]=m=>e(p).precio=m),rules:["requiredValidator"in o?o.requiredValidator:e($)],label:"Precio",placeholder:"precio"},null,8,["modelValue","rules"])]),_:1}),a(B,{cols:"12"},{default:r(()=>[a(O,{modelValue:e(p).duracion,"onUpdate:modelValue":i[2]||(i[2]=m=>e(p).duracion=m),rules:["requiredValidator"in o?o.requiredValidator:e($)],label:"Duración en minutos"},null,8,["modelValue","rules"])]),_:1}),a(B,{cols:"12"},{default:r(()=>[a(O,{disabled:"",modelValue:e(v),"onUpdate:modelValue":i[3]||(i[3]=m=>g(v)?v.value=m:null),label:"Hora"},null,8,["modelValue"])]),_:1}),a(B,{cols:"12"},{default:r(()=>[a(P,{disabled:!e(f),type:"submit",class:"me-4"},{default:r(()=>i[5]||(i[5]=[M(" Aceptar ")])),_:1},8,["disabled"]),a(P,{type:"reset",variant:"outlined",color:"error",onClick:x},{default:r(()=>i[6]||(i[6]=[M(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},me={class:"app-user-search-filter d-flex align-center"},ce={class:"d-flex justify-end flex-wrap gap-x-6 px-2 py-1"},ve={class:"d-flex align-center gap-x-2 text-medium-emphasis text-base"},fe={class:"d-flex align-center text-base text-high-emphasis me-2 mb-0"},Ve={class:"d-flex gap-x-2 align-center me-2"},ta={__name:"index",setup(q){I();const w=u(""),d=u(10),s=u(1),b=u(),D=u(),p=t=>{var l,_;s.value=t.page,b.value=(l=t.sortBy[0])==null?void 0:l.key,D.value=(_=t.sortBy[0])==null?void 0:_.order},C=[{title:"Nombre",key:"nombre"},{title:"Duración",key:"duracion",sortable:!1},{title:"Precio",key:"precio",sortable:!1},{title:"Acciones",key:"actions",sortable:!1}],c=u(!1),f=u(!1),x=u("success"),U=u(""),y=u(!1),V=u(null),S=u([]),v=u(0),o=async()=>{try{const t=await T("/getservicios",{method:"GET",params:{search:w.value,itemsPerPage:d.value,page:s.value,sortBy:b.value,orderBy:D.value}});console.log(t),S.value=t.data,v.value=t.total}catch(t){console.error(t)}},i=async()=>{try{const t=await T(`/deleteservicio/${V.value.id}`,{method:"GET"});let l=S.value.findIndex(_=>_.id==V.value.id);l>-1&&S.value.splice(l,1),c.value=!1,x.value="success",U.value=t.message,f.value=!0}catch(t){x.value="error",U.value=t.response._data.message,f.value=!0}},k=()=>{y.value=!0,V.value=null},m=t=>{y.value=!0,V.value=t},G=t=>{V.value=t,c.value=!0};return Z(o),N([d,b,D,s,w],()=>{o()}),N(y,async t=>{t||(V.value={})}),(t,l)=>{const _=le("IconBtn"),J=oe;return H(),ee("section",null,[a(R,{title:"Filtros",class:"mb-6"},{default:r(()=>[a(j,{class:"d-flex flex-wrap gap-4"},{default:r(()=>[h("div",me,[a(O,{modelValue:e(w),"onUpdate:modelValue":l[0]||(l[0]=n=>g(w)?w.value=n:null),placeholder:"Buscar",density:"compact",class:"me-4"},null,8,["modelValue"]),a(P,{onClick:k},{default:r(()=>l[9]||(l[9]=[M(" Agregar nuevo servicio ")])),_:1})])]),_:1}),a(ue,{"items-per-page":e(d),"onUpdate:itemsPerPage":l[4]||(l[4]=n=>g(d)?d.value=n:null),page:e(s),"onUpdate:page":l[5]||(l[5]=n=>g(s)?s.value=n:null),items:e(S),"item-value":"id","items-length":e(v),headers:C,class:"text-no-wrap rounded-0","onUpdate:options":p},{"item.actions":r(({item:n})=>[a(_,{size:"small",onClick:Q=>G(n)},{default:r(()=>[a(A,{icon:"ri-delete-bin-7-line"})]),_:2},1032,["onClick"]),a(_,{size:"small",onClick:Q=>m(n)},{default:r(()=>[a(A,{icon:"ri-edit-box-line",title:"Editar"})]),_:2},1032,["onClick"])]),bottom:r(()=>[a(z),h("div",ce,[h("div",ve,[l[10]||(l[10]=M(" Filas por página: ")),a(de,{modelValue:e(d),"onUpdate:modelValue":l[1]||(l[1]=n=>g(d)?d.value=n:null),class:"per-page-select",variant:"plain",items:[10,20,25,50,100]},null,8,["modelValue"])]),h("p",fe,E(("paginationMeta"in t?t.paginationMeta:e(K))({page:e(s),itemsPerPage:e(d)},e(v))),1),h("div",Ve,[a(P,{class:"flip-in-rtl",icon:"ri-arrow-left-s-line",variant:"text",density:"comfortable",color:"high-emphasis",disabled:e(s)<=1,onClick:l[2]||(l[2]=n=>e(s)<=1?s.value=1:s.value--)},null,8,["disabled"]),a(P,{class:"flip-in-rtl",icon:"ri-arrow-right-s-line",density:"comfortable",variant:"text",color:"high-emphasis",disabled:e(s)>=Math.ceil(e(v)/e(d)),onClick:l[3]||(l[3]=n=>e(s)>=Math.ceil(e(v)/e(d))?s.value=Math.ceil(e(v)/e(d)):s.value++)},null,8,["disabled"])])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),a(pe,{isDrawerOpen:e(y),"onUpdate:isDrawerOpen":l[6]||(l[6]=n=>g(y)?y.value=n:null),item:e(V),onRefresh:o},null,8,["isDrawerOpen","item"]),a(J,{isDialogVisible:e(c),"onUpdate:isDialogVisible":l[7]||(l[7]=n=>g(c)?c.value=n:null),confirmationQuestion:"¿Está seguro que desea eliminar el servicio seleccionado?",onConfirm:i},null,8,["isDialogVisible"]),a(ae,{location:"top end",modelValue:e(f),"onUpdate:modelValue":l[8]||(l[8]=n=>g(f)?f.value=n:null),color:e(x)},{default:r(()=>[M(E(e(U)),1)]),_:1},8,["modelValue","color"])])}}};export{ta as default};
