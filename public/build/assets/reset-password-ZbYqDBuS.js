import{p as v,r as k,c as x}from"./validators-CrSGMxiT.js";import{r as n,o as S,c as F,d as i,b as r,e as s,n as a,J as y,x as b,am as T,af as M,v as g,a0 as N,ag as j,aM as B,F as I,j as L,k as E,a as U,ak as D}from"./main-BwDGDDDW.js";import{m as $,a as z}from"./misc-mask-light-5ES0rqJi.js";import{V as A}from"./VNodeRenderer-CnOOVAWO.js";import{o as G}from"./index-D8byVCHt.js";import{u as J}from"./useGenerateImageVariant-CBWzYAkz.js";import{V as P}from"./VCardText-BKkdmkn-.js";import{V as O}from"./VForm-DbaU_ACV.js";import{V as H,a as V}from"./VRow-DJH2tZVu.js";import{V as q}from"./VTextField-DqZOZREA.js";import{V as K}from"./VCard-Cpw0jw9u.js";import"./helpers-DK5QwNv0.js";import"./index-9rIf2CJL.js";import"./VAvatar-DYn3is-W.js";import"./VImg-BYy41-F9.js";import"./form-BEvPHhJ7.js";/* empty css              *//* empty css                   */import"./VCounter-IA5S7b1U.js";import"./VField-5sqsN37e.js";import"./VInput-CVFVwJKu.js";const Q={class:"auth-wrapper d-flex align-center justify-center pa-4"},W={class:"d-flex align-center gap-x-3 justify-center mb-6"},X={class:"auth-title"},Y={class:"d-flex align-center justify-center"},Z=["src"],Pe={__name:"reset-password",setup(ee){const C=J(z,$),l=n({newPassword:"",confirmPassword:""}),u=L(),_=E(),w=n(),m=n(!1),p=n(!1),d=n(!1),f=n("");console.log("qlq",csrf_token);const h=async()=>{try{await G("/api/update-password",{method:"POST",body:{_token:csrf_token,email:u.query.email,password:l.value.newPassword,password_confirmation:l.value.confirmPassword,token:u.query.token},onResponseError({response:e}){var c,t;((t=(c=e==null?void 0:e._data)==null?void 0:c.error)==null?void 0:t.password)!=null?f.value=e._data.errors.password:f.value=e._data.message,d.value=!0}})!="passwords.reset"?(f.value="La sesion ha expirado, debe volver a pedir un cambio de contrase帽a",d.value=!0):await D(()=>{_.replace(u.query.to?String(u.query.to):"/")})}catch(o){console.error(o)}},R=()=>{var o;(o=w.value)==null||o.validate().then(({valid:e})=>{e&&h()})};return(o,e)=>{const c=U("RouterLink");return S(),F(I,null,[i("div",Q,[r(K,{class:"auth-card pa-sm-4 pa-md-7 pa-0","max-width":"460"},{default:s(()=>[r(P,null,{default:s(()=>[i("div",W,[r(a(A),{nodes:a(y).app.logo},null,8,["nodes"]),i("h1",X,b(a(y).app.title),1)]),e[5]||(e[5]=i("h4",{class:"text-h4 mb-1"}," Restablecer Contrase帽a  ",-1)),e[6]||(e[6]=i("p",{class:"mb-0"}," Escribe tu nueva contrase帽a y aseg煤rese de cumplir con los requerimientos. ",-1)),e[7]||(e[7]=i("p",null," Al confirmar se redirigir谩 a la p谩gina de inicio de sesi贸n. ",-1))]),_:1}),r(P,null,{default:s(()=>[r(O,{ref_key:"refVForm",ref:w,onSubmit:T(R,["prevent"])},{default:s(()=>[r(H,null,{default:s(()=>[r(V,{cols:"12"},{default:s(()=>[r(q,{modelValue:a(l).newPassword,"onUpdate:modelValue":e[0]||(e[0]=t=>a(l).newPassword=t),autofocus:"",label:"Nueva contrase帽a",placeholder:"路路路路路路路路路路路路",type:a(m)?"text":"password","append-inner-icon":a(m)?"ri-eye-off-line":"ri-eye-line","onClick:appendInner":e[1]||(e[1]=t=>m.value=!a(m)),rules:["passwordValidator"in o?o.passwordValidator:a(v),"requiredValidator"in o?o.requiredValidator:a(k)]},null,8,["modelValue","type","append-inner-icon","rules"])]),_:1}),r(V,{cols:"12"},{default:s(()=>[r(q,{modelValue:a(l).confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>a(l).confirmPassword=t),label:"Confirmar contrase帽a",placeholder:"路路路路路路路路路路路路",type:a(p)?"text":"password","append-inner-icon":a(p)?"ri-eye-off-line":"ri-eye-line","onClick:appendInner":e[3]||(e[3]=t=>p.value=!a(p)),rules:["passwordValidator"in o?o.passwordValidator:a(v),"requiredValidator"in o?o.requiredValidator:a(k),("confirmedValidator"in o?o.confirmedValidator:a(x))(a(l).confirmPassword,a(l).newPassword)]},null,8,["modelValue","type","append-inner-icon","rules"])]),_:1}),r(V,{cols:"12"},{default:s(()=>[r(M,{block:"",type:"submit"},{default:s(()=>e[8]||(e[8]=[g(" Confirmar ")])),_:1})]),_:1}),r(V,null,{default:s(()=>[i("div",Y,[r(c,{to:{name:"login"}},{default:s(()=>[r(N,{icon:"ri-arrow-left-s-line",size:"20",class:"flip-in-rtl me-2"}),e[9]||(e[9]=i("span",null,"Volver al inicio de sesi贸n",-1))]),_:1})])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}),i("img",{class:"auth-footer-mask d-none d-md-block",src:a(C),height:"172"},null,8,Z)]),r(a(B),{modelValue:a(d),"onUpdate:modelValue":e[4]||(e[4]=t=>j(d)?d.value=t:null),location:"top end",color:"error"},{default:s(()=>[g(b(a(f)),1)]),_:1},8,["modelValue"])],64)}}};export{Pe as default};
