import{f as Ue,b as ze}from"./formatters-zPA0pF4b.js";import{r as R,a as se,o as v,f as T,e as t,b as e,a0 as r,v as y,d as o,n as l,ag as K,as as pe,c as C,z as q,af as ie,F as E,i as B,s as fe,x as _,j as ke,L as G,M as J,am as j,y as le,at as Te,a6 as Q,w as Be,K as Pe}from"./main-DXTHM_Z4.js";import{_ as xe}from"./MoreBtn-gEltqhL4.js";import{P as me}from"./vue3-perfect-scrollbar.esm-CQjiEb9s.js";import{I as be,L as ye}from"./index-CVgdfK3x.js";import{u as Ce,S as $e,P as _e,U as we,E as he}from"./index-DbX3YSL7.js";import{a as Ne,b as Oe,V as ae}from"./VCard-BBjecQUS.js";import{V as X}from"./VTextField-BfMLnCIA.js";import{V as z}from"./VDivider-CVdsTcIK.js";import{V as Y}from"./VMenu-D1AAVsYt.js";import{V as Z,a as ne,b as oe}from"./VList-5epMYaPo.js";import{V as W}from"./VSpacer-B26ty9bD.js";import{V as Ve}from"./VChip-CoWdbaPm.js";import{$ as ve}from"./api-CWHLgCqw.js";import{V as U}from"./VTooltip-DgOqqJD2.js";import{V as Le}from"./VBadge-CPdpzMCR.js";import{V as te}from"./VCardText-DGP4d7zZ.js";import{V as Me}from"./VAvatar-QubjHI1z.js";import{V as de}from"./VImg-DTTLi8N3.js";import{V as Se}from"./VNavigationDrawer-CS8amoRg.js";import{u as Fe,V as je,a as qe}from"./VMain-LjVEQ5mw.js";import{u as He}from"./useApi-D06Wc7pK.js";import{c as Ke}from"./createUrl-n8nET3pc.js";import{V as ge}from"./VCheckbox-CVRX89Q0.js";import"./helpers-DK5QwNv0.js";/* empty css                   */import"./VCounter-CfjE-LQa.js";import"./VField-B2YWi8oL.js";import"./form-ijrz4ipO.js";import"./VInput-BZH6jw62.js";import"./dialog-transition-CqXIoDZd.js";import"./ssrBoot-BzQpit4r.js";/* empty css              */import"./index-D1tqMycq.js";import"./index-9rIf2CJL.js";import"./VCheckboxBtn-DNkfUJpf.js";import"./VSelectionControl-DqCfd3An.js";const Ge={class:"pe-5"},Je={class:"cursor-pointer text-medium-emphasis"},We={key:0},Qe={key:0},Xe={class:"tiptap-editor-wrapper"},Ye={key:0,class:"d-flex flex-wrap gap-x-1 px-4 py-2"},Ze={class:"mx-5"},et={class:"d-flex align-center px-5 py-4 gap-4"},tt={__name:"ComposeDialog",emits:["close"],setup(S,{emit:I}){const c=R(""),L=R(""),$=R(""),w=R(""),D=R(""),x=R(!1),g=R(!1),h=()=>{c.value=w.value=D.value=""},d=Ce({content:"",extensions:[$e,be,_e.configure({placeholder:"Message"}),we,ye.configure({openOnClick:!1})]}),P=()=>{var u,i,f;const M=(u=d.value)==null?void 0:u.getAttributes("link").href,a=window.prompt("URL",M);if(a!==null){if(a===""){(i=d.value)==null||i.chain().focus().extendMarkRange("link").unsetLink().run();return}(f=d.value)==null||f.chain().focus().extendMarkRange("link").setLink({href:a}).run()}},k=()=>{var a;const M=window.prompt("URL");M&&((a=d.value)==null||a.chain().focus().setImage({src:M}).run())};return(M,a)=>{const u=se("IconBtn");return v(),T(ae,{class:"email-compose-dialog",elevation:"24","max-width":"30vw"},{default:t(()=>[e(Ne,{class:"py-3"},{append:t(()=>[e(u,{onClick:a[0]||(a[0]=i=>M.$emit("close"))},{default:t(()=>[e(r,{icon:"ri-subtract-line"})]),_:1}),e(u,{onClick:a[1]||(a[1]=i=>{M.$emit("close"),h()})},{default:t(()=>[e(r,{icon:"ri-close-line"})]),_:1})]),default:t(()=>[e(Oe,{class:"text-medium-emphasis"},{default:t(()=>a[14]||(a[14]=[y(" Compose Mail ")])),_:1})]),_:1}),o("div",Ge,[e(X,{modelValue:l(c),"onUpdate:modelValue":a[4]||(a[4]=i=>K(c)?c.value=i:null),density:"compact"},{"prepend-inner":t(()=>a[15]||(a[15]=[o("div",{class:"text-disabled font-weight-medium"}," To: ",-1)])),append:t(()=>[o("span",Je,[o("span",{onClick:a[2]||(a[2]=i=>x.value=!l(x))},"Cc"),a[16]||(a[16]=o("span",{class:"mx-1"},"|",-1)),o("span",{onClick:a[3]||(a[3]=i=>g.value=!l(g))},"Bcc")])]),_:1},8,["modelValue"])]),e(pe,null,{default:t(()=>[l(x)?(v(),C("div",We,[e(z),e(X,{modelValue:l(L),"onUpdate:modelValue":a[5]||(a[5]=i=>K(L)?L.value=i:null),density:"compact"},{"prepend-inner":t(()=>a[17]||(a[17]=[o("div",{class:"text-disabled font-weight-medium"}," Cc: ",-1)])),_:1},8,["modelValue"])])):q("",!0)]),_:1}),e(pe,null,{default:t(()=>[l(g)?(v(),C("div",Qe,[e(z),e(X,{modelValue:l($),"onUpdate:modelValue":a[6]||(a[6]=i=>K($)?$.value=i:null),density:"compact"},{"prepend-inner":t(()=>a[18]||(a[18]=[o("div",{class:"text-disabled font-weight-medium"}," Bcc: ",-1)])),_:1},8,["modelValue"])])):q("",!0)]),_:1}),e(z),e(X,{modelValue:l(w),"onUpdate:modelValue":a[7]||(a[7]=i=>K(w)?w.value=i:null),density:"compact"},{"prepend-inner":t(()=>a[19]||(a[19]=[o("div",{class:"text-disabled font-weight-medium"}," Subject: ",-1)])),_:1},8,["modelValue"]),e(z),o("div",Xe,[l(d)?(v(),C("div",Ye,[e(u,{rounded:"",color:l(d).isActive("bold")?"primary":"",variant:l(d).isActive("bold")?"tonal":"text",onClick:a[8]||(a[8]=i=>l(d).chain().focus().toggleBold().run())},{default:t(()=>[e(r,{icon:"ri-bold"})]),_:1},8,["color","variant"]),e(u,{rounded:"",color:l(d).isActive("underline")?"primary":"",variant:l(d).isActive("underline")?"tonal":"text",onClick:a[9]||(a[9]=i=>l(d).commands.toggleUnderline())},{default:t(()=>[e(r,{icon:"ri-underline"})]),_:1},8,["color","variant"]),e(u,{rounded:"",color:l(d).isActive("italic")?"primary":"",variant:l(d).isActive("italic")?"tonal":"text",onClick:a[10]||(a[10]=i=>l(d).chain().focus().toggleItalic().run())},{default:t(()=>[e(r,{icon:"ri-italic"})]),_:1},8,["color","variant"]),e(u,{rounded:"",color:l(d).isActive("bulletList")?"primary":"",variant:l(d).isActive("bulletList")?"tonal":"text",onClick:a[11]||(a[11]=i=>l(d).chain().focus().toggleBulletList().run())},{default:t(()=>[e(r,{icon:"ri-list-check"})]),_:1},8,["color","variant"]),e(u,{rounded:"",color:l(d).isActive("orderedList")?"primary":"",variant:l(d).isActive("orderedList")?"tonal":"text",onClick:a[12]||(a[12]=i=>l(d).chain().focus().toggleOrderedList().run())},{default:t(()=>[e(r,{icon:"ri-list-ordered-2"})]),_:1},8,["color","variant"]),e(u,{rounded:"",onClick:P},{default:t(()=>[e(r,{icon:"ri-links-line"})]),_:1}),e(u,{rounded:"",onClick:k},{default:t(()=>[e(r,{icon:"ri-image-line"})]),_:1})])):q("",!0),e(z),o("div",Ze,[e(l(he),{editor:l(d)},null,8,["editor"])])]),o("div",et,[e(ie,{"append-icon":"ri-send-plane-line"},{default:t(()=>[a[20]||(a[20]=y(" Send ")),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{items:["Schedule Mail","Save Draft"]})]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(r,{icon:"ri-attachment-2"})]),_:1}),e(W),e(u,null,{default:t(()=>[e(r,{icon:"ri-more-2-line"})]),_:1}),e(u,{onClick:a[13]||(a[13]=i=>{M.$emit("close"),h()})},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"})]),_:1})])]),_:1})}}},lt={class:"d-flex flex-column h-100"},it={class:"pa-5"},at={class:"email-filters-labels"},nt=["href","onClick"],ot=["href","onClick"],st=Object.assign({inheritAttrs:!1},{__name:"EmailLeftSidebarContent",emits:["toggleComposeDialogVisibility"],setup(S,{emit:I}){const c=[{title:"Inbox",prependIcon:"ri-mail-line",to:{name:"apps-email"},badge:{content:"21",color:"primary"}},{title:"Sent",prependIcon:"ri-send-plane-line",to:{name:"apps-email-filter",params:{filter:"sent"}}},{title:"Draft",prependIcon:"ri-edit-box-line",to:{name:"apps-email-filter",params:{filter:"draft"}},badge:{content:"2",color:"warning"}},{title:"Starred",prependIcon:"ri-star-line",to:{name:"apps-email-filter",params:{filter:"starred"}}},{title:"Spam",prependIcon:"ri-spam-2-line",to:{name:"apps-email-filter",params:{filter:"spam"}},badge:{content:"4",color:"error"}},{title:"Trash",prependIcon:"ri-delete-bin-7-line",to:{name:"apps-email-filter",params:{filter:"trashed"}}}],L=[{title:"Personal",color:"success",to:{name:"apps-email-label",params:{label:"personal"}}},{title:"Company",color:"primary",to:{name:"apps-email-label",params:{label:"company"}}},{title:"Important",color:"warning",to:{name:"apps-email-label",params:{label:"important"}}},{title:"Private",color:"error",to:{name:"apps-email-label",params:{label:"private"}}}];return($,w)=>{const D=se("RouterLink");return v(),C("div",lt,[o("div",it,[e(ie,{block:"",onClick:w[0]||(w[0]=x=>$.$emit("toggleComposeDialogVisibility"))},{default:t(()=>w[1]||(w[1]=[y(" Compose ")])),_:1})]),e(l(me),{options:{wheelPropagation:!1},class:"h-100 pt-4"},{default:t(()=>[o("ul",at,[(v(),C(E,null,B(c,x=>e(D,{key:x.title,class:"d-flex align-center cursor-pointer",to:x.to,custom:""},{default:t(({isActive:g,href:h,navigate:d})=>{var P;return[o("li",fe({ref_for:!0},$.$attrs,{href:h,class:[g&&"email-filter-active text-primary","d-flex align-center cursor-pointer"],onClick:d}),[e(r,{icon:x.prependIcon,class:"me-2",size:"20"},null,8,["icon"]),o("span",null,_(x.title),1),e(W),(P=x.badge)!=null&&P.content?(v(),T(Ve,{key:0,size:"x-small",color:x.badge.color},{default:t(()=>[y(_(x.badge.content),1)]),_:2},1032,["color"])):q("",!0)],16,nt)]}),_:2},1032,["to"])),64)),w[2]||(w[2]=o("li",{class:"text-sm d-block text-uppercase text-disabled mt-9 mb-4"}," LABELS ",-1)),(v(),C(E,null,B(L,x=>e(D,{key:x.title,class:"d-flex align-center",to:x.to,custom:""},{default:t(({isActive:g,href:h,navigate:d})=>[o("li",fe({ref_for:!0},$.$attrs,{href:h,class:[g&&"email-label-active text-primary","cursor-pointer"],onClick:d}),[e(r,{color:x.color,icon:"ri-circle-fill",size:"12",class:"me-2"},null,8,["color"]),o("span",null,_(x.title),1)],16,ot)]),_:2},1032,["to"])),64))])]),_:1})])}}}),ue=()=>{const S=ke(),I=async(g,h)=>{await ve("apps/email",{method:"POST",body:JSON.stringify({ids:g,data:h})})};return{labels:[{title:"personal",color:"success"},{title:"company",color:"primary"},{title:"important",color:"warning"},{title:"private",color:"error"}],resolveLabelColor:g=>g==="personal"?"success":g==="company"?"primary":g==="important"?"warning":g==="private"?"error":"secondary",shallShowMoveToActionFor:g=>g==="trash"?S.params.filter!=="trashed":g==="inbox"?!(S.params.filter===void 0||S.params.filter==="sent"||S.params.filter==="draft"):g==="spam"?!(S.params.filter==="spam"||S.params.filter==="sent"||S.params.filter==="draft"):!1,emailMoveToFolderActions:[{action:"inbox",icon:"ri-mail-line"},{action:"spam",icon:"ri-spam-2-line"},{action:"trash",icon:"ri-delete-bin-line"}],moveSelectedEmailTo:(g,h)=>{const d={};g==="inbox"?(S.params.filter==="trashed"&&(d.isDeleted=!1),d.folder="inbox"):g==="spam"?(S.params.filter==="trashed"&&(d.isDeleted=!1),d.folder="spam"):g==="trash"&&(d.isDeleted=!0),I(h,d)},updateEmails:I,updateEmailLabels:async(g,h)=>{await ve("/apps/email",{method:"POST",body:{ids:g,label:h}})}}},rt={class:"email-view-header d-flex align-center px-5 py-4"},dt={class:"d-flex align-center flex-wrap flex-grow-1 overflow-hidden gap-2"},ut={class:"text-h6 font-weight-regular text-truncate"},mt={class:"d-flex flex-wrap gap-2"},ct={class:"d-flex align-center gap-2"},pt={class:"email-view-action-bar d-flex align-center text-medium-emphasis gap-1 px-5"},ft={class:"d-flex align-start"},vt={class:"d-flex flex-wrap flex-grow-1 overflow-hidden"},gt={class:"text-truncate"},kt={class:"text-h6 font-weight-regular text-truncate"},xt={class:"text-body-2 mb-0"},bt={class:"d-flex align-center"},yt={class:"text-disabled me-4"},Ct=["innerHTML"],$t={class:"tiptap-editor-wrapper"},_t={key:0,class:"d-flex flex-wrap gap-x-2 mb-6"},wt={class:"d-flex align-center justify-end mt-6"},ht={__name:"EmailView",props:{email:{type:null,required:!0},emailMeta:{type:Object,required:!0}},emits:["refresh","navigated","close","trash","unread","read","star","unstar"],setup(S,{emit:I}){const c=S,L=I,{updateEmailLabels:$}=ue(),{labels:w,resolveLabelColor:D,emailMoveToFolderActions:x,shallShowMoveToActionFor:g,moveSelectedEmailTo:h}=ue(),d=u=>{h(u,[c.email.id]),L("refresh"),L("close")},P=async u=>{await $([c.email.id],u),L("refresh")},k=Ce({content:"",extensions:[$e,be,_e.configure({placeholder:"Write a Comment..."}),we,ye.configure({openOnClick:!1})]}),M=()=>{var f,O,m;const u=(f=k.value)==null?void 0:f.getAttributes("link").href,i=window.prompt("URL",u);if(i!==null){if(i===""){(O=k.value)==null||O.chain().focus().extendMarkRange("link").unsetLink().run();return}(m=k.value)==null||m.chain().focus().extendMarkRange("link").setLink({href:i}).run()}},a=()=>{var i;const u=window.prompt("URL");u&&((i=k.value)==null||i.chain().focus().setImage({src:u}).run())};return(u,i)=>{const f=se("IconBtn"),O=xe;return v(),T(Se,{temporary:"","model-value":!!c.email,location:"right",scrim:!1,floating:"",class:"email-view"},{default:t(()=>[c.email?(v(),C(E,{key:0},[o("div",rt,[e(f,{class:"me-2 flip-in-rtl",onClick:i[0]||(i[0]=m=>u.$emit("close"))},{default:t(()=>[e(r,{icon:"ri-arrow-left-s-line"})]),_:1}),o("div",dt,[o("h6",ut,_(c.email.subject),1),o("div",mt,[(v(!0),C(E,null,B(c.email.labels,m=>(v(),T(Ve,{key:m,color:l(D)(m),size:"small",class:"text-capitalize flex-shrink-0"},{default:t(()=>[y(_(m),1)]),_:2},1032,["color"]))),128))])]),o("div",ct,[e(f,{variant:"plain",disabled:!c.emailMeta.hasPreviousEmail,class:"flip-in-rtl",onClick:i[1]||(i[1]=m=>u.$emit("navigated","previous"))},{default:t(()=>[e(r,{icon:"ri-arrow-left-s-line"})]),_:1},8,["disabled"]),e(f,{variant:"plain",class:"flip-in-rtl",disabled:!c.emailMeta.hasNextEmail,onClick:i[2]||(i[2]=m=>u.$emit("navigated","next"))},{default:t(()=>[e(r,{icon:"ri-arrow-right-s-line"})]),_:1},8,["disabled"])])]),e(z),o("div",pt,[G(e(f,{onClick:i[3]||(i[3]=m=>{u.$emit("trash"),u.$emit("close")})},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>i[11]||(i[11]=[y(" Delete Mail ")])),_:1})]),_:1},512),[[J,!c.email.isDeleted]]),e(f,{onClick:i[4]||(i[4]=j(m=>{u.$emit("unread"),u.$emit("close")},["stop"]))},{default:t(()=>[e(r,{icon:"ri-mail-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>i[12]||(i[12]=[y(" Mark as Unread ")])),_:1})]),_:1}),e(f,null,{default:t(()=>[e(r,{icon:"ri-folder-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>i[13]||(i[13]=[y(" Move to ")])),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),C(E,null,B(l(x),m=>(v(),T(ne,{key:m.title,class:le([l(g)(m.action)?"d-flex":"d-none","align-center"]),href:"#",onClick:F=>d(m.action)},{prepend:t(()=>[e(r,{icon:m.icon,class:"me-2",size:"20"},null,8,["icon"])]),default:t(()=>[e(oe,{class:"text-capitalize"},{default:t(()=>[y(_(m.action),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(r,{icon:"ri-price-tag-3-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>i[14]||(i[14]=[y(" Label ")])),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),C(E,null,B(l(w),m=>(v(),T(ne,{key:m.title,href:"#",onClick:j(F=>P(m.title),["stop"])},{prepend:t(()=>[e(Le,{inline:"",color:l(D)(m.title),dot:""},null,8,["color"])]),default:t(()=>[e(oe,{class:"ms-2 text-capitalize"},{default:t(()=>[y(_(m.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(W),e(f,{color:c.email.isStarred?"warning":"default",onClick:i[5]||(i[5]=m=>{var F;return(F=c.email)!=null&&F.isStarred?u.$emit("unstar"):u.$emit("star")})},{default:t(()=>[e(r,{icon:"ri-star-line"})]),_:1},8,["color"]),e(O)]),e(z),e(l(me),{tag:"div",class:"mail-content-container flex-grow-1",options:{wheelPropagation:!1}},{default:t(()=>[e(ae,{class:"ma-6 mb-4"},{default:t(()=>[e(te,{class:"mail-header"},{default:t(()=>[o("div",ft,[e(Me,{size:"38",class:"me-3"},{default:t(()=>[e(de,{src:c.email.from.avatar,alt:c.email.from.name},null,8,["src","alt"])]),_:1}),o("div",vt,[o("div",gt,[o("h6",kt,_(c.email.from.name),1),o("p",xt,_(c.email.from.email),1)]),e(W),o("div",bt,[o("span",yt,_(("formatDate"in u?u.formatDate:l(Ue))(c.email.time)),1),G(e(f,null,{default:t(()=>[e(r,{icon:"ri-attachment-2"})]),_:1},512),[[J,c.email.attachments.length]])])]),e(O,{class:"align-self-sm-center"})])]),_:1}),e(z),e(te,null,{default:t(()=>[o("div",{class:"text-base",innerHTML:c.email.message},null,8,Ct)]),_:1}),c.email.attachments.length?(v(),C(E,{key:0},[e(z),e(te,{class:"d-flex flex-column gap-y-4"},{default:t(()=>[i[15]||(i[15]=o("span",null,"Attachments",-1)),(v(!0),C(E,null,B(c.email.attachments,m=>(v(),C("div",{key:m.fileName,class:"d-flex align-center"},[e(de,{src:m.thumbnail,alt:m.fileName,"aspect-ratio":"1","max-height":"24","max-width":"24",class:"me-2"},null,8,["src","alt"]),o("span",null,_(m.fileName),1)]))),128))]),_:1})],64)):q("",!0)]),_:1}),e(ae,{class:"ma-6"},{default:t(()=>[e(te,null,{default:t(()=>[i[18]||(i[18]=o("h6",{class:"text-h6 font-weight-regular mb-6"}," Reply to Ross Geller ",-1)),o("div",$t,[l(k)?(v(),C("div",_t,[e(r,{icon:"ri-bold",color:l(k).isActive("bold")?"primary":"",size:"20",onClick:i[6]||(i[6]=m=>l(k).chain().focus().toggleBold().run())},null,8,["color"]),e(r,{color:l(k).isActive("underline")?"primary":"",icon:"ri-underline",size:"20",onClick:i[7]||(i[7]=m=>l(k).commands.toggleUnderline())},null,8,["color"]),e(r,{color:l(k).isActive("italic")?"primary":"",icon:"ri-italic",size:"20",onClick:i[8]||(i[8]=m=>l(k).chain().focus().toggleItalic().run())},null,8,["color"]),e(r,{color:l(k).isActive("bulletList")?"primary":"",icon:"ri-list-check",size:"20",onClick:i[9]||(i[9]=m=>l(k).chain().focus().toggleBulletList().run())},null,8,["color"]),e(r,{color:l(k).isActive("orderedList")?"primary":"",icon:"ri-list-ordered-2",size:"20",onClick:i[10]||(i[10]=m=>l(k).chain().focus().toggleOrderedList().run())},null,8,["color"]),e(r,{icon:"ri-links-line",size:"20",onClick:M}),e(r,{icon:"ri-image-line",size:"20",onClick:a})])):q("",!0),e(l(he),{editor:l(k)},null,8,["editor"])]),o("div",wt,[e(ie,{color:"secondary",variant:"plain",class:"me-4"},{default:t(()=>[e(r,{icon:"ri-attachment-2"}),i[16]||(i[16]=o("span",null,"Attachments",-1))]),_:1}),e(ie,null,{default:t(()=>[i[17]||(i[17]=o("span",null,"Send",-1)),e(r,{icon:"ri-send-plane-line"})]),_:1})])]),_:1})]),_:1})]),_:1})],64)):q("",!0)]),_:1},8,["model-value"])}}},Vt={class:"d-flex align-center"},Lt={class:"py-2 px-4 d-flex align-center"},Mt=["onClick"],St={class:"text-h6"},At={class:"text-body-2 truncate"},Et={class:"text-sm text-disabled"},It={class:"email-actions d-none"},Dt={class:"py-4 px-5 text-center"},kl={__name:"index",async setup(S){let I,c;const{isLeftSidebarOpen:L}=Fe(),$=ke(),{labels:w,resolveLabelColor:D,emailMoveToFolderActions:x,shallShowMoveToActionFor:g,moveSelectedEmailTo:h,updateEmails:d,updateEmailLabels:P}=ue(),k=R(!1),M=R(""),a=R([]),{data:u,execute:i}=([I,c]=Te(()=>He(Ke("/apps/email",{query:{q:M,filter:()=>"filter"in $.params?$.params.filter:void 0,label:()=>"label"in $.params?$.params.label:void 0}}))),I=await I,c(),I),f=Q(()=>u.value.emails),O=p=>{const n=a.value.indexOf(p);n===-1?a.value.push(p):a.value.splice(n,1)},m=Q(()=>f.value.length&&f.value.length===a.value.length),F=Q(()=>!!a.value.length&&f.value.length!==a.value.length),re=Q(()=>a.value.every(p=>{var n;return(n=f.value.find(V=>V.id===p))==null?void 0:n.isRead})),Ae=()=>{a.value=m.value?[]:f.value.map(p=>p.id)},b=R(null),Ee=Q(()=>{const p={hasNextEmail:!1,hasPreviousEmail:!1};if(b.value){const n=f.value.findIndex(V=>{var H;return V.id===((H=b.value)==null?void 0:H.id)});p.hasNextEmail=!!f.value[n+1],p.hasPreviousEmail=!!f.value[n-1]}return p}),ce=async()=>{await i(),b.value&&(b.value=f.value.find(p=>{var n;return p.id===((n=b.value)==null?void 0:n.id)}))},A=async(p,n=a.value)=>{a.value=[],n.length&&(p==="trash"?await d(n,{isDeleted:!0}):p==="spam"?await d(n,{folder:"spam"}):p==="unread"?await d(n,{isRead:!1}):p==="read"?await d(n,{isRead:!0}):p==="star"?await d(n,{isStarred:!0}):p==="unstar"&&await d(n,{isStarred:!1}),await i(),b.value&&ce())},Ie=async p=>{h(p,a.value),await i()},De=p=>{if(!b.value)return;const n=f.value.findIndex(H=>{var s;return H.id===((s=b.value)==null?void 0:s.id)}),V=p==="previous"?n-1:n+1;b.value=f.value[V]},Re=async p=>{b.value=p,await A("read",[p.id])};return Be(()=>$.params,()=>{a.value=[]},{deep:!0}),(p,n)=>{const V=se("IconBtn"),H=xe;return v(),T(je,{style:{"min-block-size":"100%"},class:"email-app-layout"},{default:t(()=>[e(Se,{modelValue:l(L),"onUpdate:modelValue":n[1]||(n[1]=s=>K(L)?L.value=s:null),absolute:"",touchless:"",location:"start",temporary:p.$vuetify.display.mdAndDown},{default:t(()=>[e(st,{onToggleComposeDialogVisibility:n[0]||(n[0]=s=>k.value=!l(k))})]),_:1},8,["modelValue","temporary"]),e(ht,{email:l(b),"email-meta":l(Ee),onRefresh:ce,onNavigated:De,onClose:n[2]||(n[2]=s=>b.value=null),onRemove:n[3]||(n[3]=s=>A("trash",l(b)?[l(b).id]:[])),onUnread:n[4]||(n[4]=s=>A("unread",l(b)?[l(b).id]:[])),onStar:n[5]||(n[5]=s=>A("star",l(b)?[l(b).id]:[])),onUnstar:n[6]||(n[6]=s=>A("unstar",l(b)?[l(b).id]:[]))},null,8,["email","email-meta"]),e(qe,null,{default:t(()=>[e(ae,{flat:"",class:"email-content-list h-100 d-flex flex-column"},{default:t(()=>[o("div",Vt,[e(V,{class:"d-lg-none ms-3",onClick:n[7]||(n[7]=s=>L.value=!0)},{default:t(()=>[e(r,{icon:"ri-menu-line"})]),_:1}),e(X,{modelValue:l(M),"onUpdate:modelValue":n[8]||(n[8]=s=>K(M)?M.value=s:null),density:"default",class:"email-search px-1 flex-grow-1",placeholder:"Search mail"},{"prepend-inner":t(()=>[e(r,{color:"disabled",size:"22",icon:"ri-search-line"})]),_:1},8,["modelValue"])]),e(z),o("div",Lt,[e(ge,{"model-value":l(m),indeterminate:l(F),class:"me-1","onUpdate:modelValue":Ae},null,8,["model-value","indeterminate"]),o("div",{class:"w-100 d-flex align-center action-bar-actions gap-1",style:Pe({visibility:l(F)||l(m)?void 0:"hidden"})},[G(e(V,{onClick:n[9]||(n[9]=s=>A("trash"))},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>n[13]||(n[13]=[y(" Delete Mail ")])),_:1})]),_:1},512),[[J,"filter"in l($).params?l($).params.filter!=="trashed":!0]]),e(V,{onClick:n[10]||(n[10]=s=>l(re)?A("unread"):A("read"))},{default:t(()=>[e(r,{icon:l(re)?"ri-mail-line":"ri-mail-open-line"},null,8,["icon"]),e(U,{activator:"parent",location:"top"},{default:t(()=>[y(_(l(re)?"Mark as Unread":"Mark as Read"),1)]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(r,{icon:"ri-folder-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>n[14]||(n[14]=[y(" Folder ")])),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),C(E,null,B(l(x),s=>(v(),T(ne,{key:s.title,class:le([l(g)(s.action)?"d-flex":"d-none","align-center"]),href:"#",onClick:ee=>Ie(s.action)},{prepend:t(()=>[e(r,{icon:s.icon,class:"me-2",size:"20"},null,8,["icon"])]),default:t(()=>[e(oe,{class:"text-capitalize"},{default:t(()=>[y(_(s.action),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(r,{icon:"ri-price-tag-3-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>n[15]||(n[15]=[y(" Label ")])),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),C(E,null,B(l(w),s=>(v(),T(ne,{key:s.title,href:"#",onClick:ee=>l(P)(l(a),s.title)},{prepend:t(()=>[e(Le,{inline:"",color:l(D)(s.title),dot:""},null,8,["color"])]),default:t(()=>[e(oe,{class:"ms-2 text-capitalize"},{default:t(()=>[y(_(s.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})],4),e(W),e(V,{class:"me-1",onClick:l(i)},{default:t(()=>[e(r,{icon:"ri-refresh-line"})]),_:1},8,["onClick"]),e(H)]),e(z),e(l(me),{tag:"ul",options:{wheelPropagation:!1},class:"email-list"},{default:t(()=>[(v(!0),C(E,null,B(l(f),s=>{var ee;return G((v(),C("li",{key:s.id,class:le(["email-item d-flex align-center pa-4 gap-2 cursor-pointer",[{"email-read":s.isRead}]]),onClick:N=>Re(s)},[e(ge,{"model-value":l(a).includes(s.id),class:"flex-shrink-0","onUpdate:modelValue":N=>O(s.id),onClick:n[11]||(n[11]=j(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"]),e(V,{color:s.isStarred?"warning":"default",onClick:j(N=>A(s.isStarred?"unstar":"star",[s.id]),["stop"])},{default:t(()=>[e(r,{icon:"ri-star-line"})]),_:2},1032,["color","onClick"]),e(Me,{size:"32"},{default:t(()=>[e(de,{src:s.from.avatar,alt:s.from.name},null,8,["src","alt"])]),_:2},1024),o("h6",St,_(s.from.name),1),o("span",At,_(s.subject),1),e(W),o("div",{class:le(["email-meta align-center gap-2",p.$vuetify.display.xs?"d-none":""])},[(v(!0),C(E,null,B(s.labels,N=>(v(),T(r,{key:N,icon:"ri-circle-fill",size:"10",color:l(D)(N)},null,8,["color"]))),128)),o("span",Et,_(("formatDateToMonthShort"in p?p.formatDateToMonthShort:l(ze))(s.time)),1)],2),o("div",It,[e(V,{onClick:j(N=>A("trash",[s.id]),["stop"])},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>n[16]||(n[16]=[y(" Delete Mail ")])),_:1})]),_:2},1032,["onClick"]),e(V,{class:"mx-2",onClick:j(N=>A(s.isRead?"unread":"read",[s.id]),["stop"])},{default:t(()=>[e(r,{icon:s.isRead?"ri-mail-line":"ri-mail-open-line"},null,8,["icon"]),e(U,{activator:"parent",location:"top"},{default:t(()=>[y(_(s.isRead?"Mark as Unread":"Mark as Read"),1)]),_:2},1024)]),_:2},1032,["onClick"]),e(V,{onClick:j(N=>A("spam",[s.id]),["stop"])},{default:t(()=>[e(r,{icon:"ri-error-warning-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>n[17]||(n[17]=[y(" Move to Spam ")])),_:1})]),_:2},1032,["onClick"])])],10,Mt)),[[J,(ee=l(f))==null?void 0:ee.length]])}),128)),G(o("li",Dt,n[18]||(n[18]=[o("span",{class:"text-high-emphasis"},"No items found.",-1)]),512),[[J,!l(f).length]])]),_:1})]),_:1}),G(e(tt,{onClose:n[12]||(n[12]=s=>k.value=!1)},null,512),[[J,l(k)]])]),_:1})]),_:1})}}};export{kl as default};
