import{f as N}from"./formatters-zPA0pF4b.js";import{$ as j}from"./api-DoG2ksOD.js";import{p as q}from"./paginationMeta-BbY5dJ0C.js";import{r as n,I as R,w as _,c as G,b as t,e as l,n as a,ag as f,o as O,v as c,x as C,a0 as w,d as m,af as V,am as Q,a as H}from"./main-XhKa_9tU.js";import{_ as J}from"./DialogCloseBtn-CNCrzKby.js";import{_ as K}from"./ConfirmDialog-CY-Jws0o.js";import{_ as L}from"./FilterComponent-CDEkahci.js";import{V as F}from"./VCard-Eaj0dfV-.js";import{V as W}from"./VDialog-0i2MyK-R.js";import{V as B}from"./VCardText-B_O88IhU.js";import{V as k}from"./VDivider-C4lH0ooT.js";import{V as X}from"./VDataTableServer-dLSgHCq6.js";import{V as Y}from"./VSelect-BBvcpHuX.js";import{V as Z}from"./VForm-BH9swDaI.js";import{V as ee,a as $}from"./VRow-CFasNknx.js";import"./helpers-DK5QwNv0.js";import"./index-C3NwvUM2.js";import"./index-9rIf2CJL.js";import"./AppDateTimePicker-CGZ5NR7j.js";import"./VField-CvyOoNAD.js";import"./form-BsyuclTd.js";import"./VInput-DCf9aRQz.js";import"./VTextField-DG88OKPn.js";/* empty css                   */import"./VCounter-zOsFyD3o.js";import"./VImg-BWevH90G.js";import"./VList-DjfFgeFe.js";import"./ssrBoot-BEJ69UV0.js";import"./VAvatar-BgIHgX1n.js";import"./VAutocomplete-Cs6bt5md.js";import"./filter-Bi6u83zm.js";import"./VMenu-D_PRx64v.js";import"./dialog-transition-B2pKVHb-.js";import"./VCheckboxBtn-CKjjSpr9.js";import"./VSelectionControl-BXoDVL8N.js";import"./VChip-BBE3Enfq.js";import"./VDataTable-CrfrFXcg.js";import"./VPagination-64W-UBzK.js";import"./VTable-Cb5v_Kut.js";/* empty css              */const te={class:"d-flex justify-end flex-wrap gap-x-6 px-2 py-1"},ae={class:"d-flex align-center gap-x-2 text-medium-emphasis text-base"},oe={class:"d-flex align-center text-base text-high-emphasis me-2 mb-0"},ie={class:"d-flex gap-x-2 align-center me-2"},Je={__name:"index",setup(le){const r=n(10),s=n(1),b=n(),x=n(),h=n([]),p=n(0),d=n({search:"",cliente:{value:null},fecha:{start:"",end:""}}),M=[{title:"Fecha de creación",type:"date",active:!0,model:"fecha"}],v=n(!1),u=n(!1),P=n(null),E=n([]),U=[{title:"Fecha",key:"fecha"},{title:"Cliente",key:"cliente.nombre"},{title:"Total",key:"total"}],y=async()=>{try{const o=await j("/get-facturas-informe",{method:"GET",params:{temp:1,search:d.value.search,fecha_inicio:d.value.fecha.start,fecha_fin:d.value.fecha.end,itemsPerPage:r.value,page:s.value,sortBy:b.value,orderBy:x.value}});h.value=o.data.data,p.value=o.data.total,h.value.push({cliente:{nombre:"Facturado:"},total:o.total})}catch(o){console.error(o)}},I=o=>{var e,g;s.value=o.page,b.value=(e=o.sortBy[0])==null?void 0:e.key,x.value=(g=o.sortBy[0])==null?void 0:g.order},S=o=>{d.value=o},T=o=>{v.value=!0,P.value=o};return R(y),_([r,b,x,s],()=>{y()}),_(d,(o,e)=>{y()},{deep:!0}),(o,e)=>{const g=L,D=H("IconBtn"),z=K,A=J;return O(),G("section",null,[t(F,{title:"Filtrar",class:"mb-6"},{default:l(()=>[t(B,{class:"d-flex flex-wrap gap-4"},{default:l(()=>[t(g,{value:a(d),headers:M,onInput:S},null,8,["value"])]),_:1}),t(k),t(X,{"items-per-page":a(r),"onUpdate:itemsPerPage":e[3]||(e[3]=i=>f(r)?r.value=i:null),page:a(s),"onUpdate:page":e[4]||(e[4]=i=>f(s)?s.value=i:null),items:a(h),"item-value":"id","items-length":a(p),headers:U,class:"text-no-wrap rounded-0","onUpdate:options":I},{"item.fecha":l(({item:i})=>[c(C(("formatDate"in o?o.formatDate:a(N))(i.fecha)),1)]),"item.total":l(({item:i})=>[c(C(parseFloat(i.total).toFixed(2))+"€ ",1)]),"item.actions":l(({item:i})=>[t(D,{size:"small",onClick:se=>T(i)},{default:l(()=>[t(w,{icon:"ri-delete-bin-7-line",title:"Eliminar"})]),_:2},1032,["onClick"]),t(D,{size:"small",to:{name:"apps-bills-view-id",params:{id:i.id}}},{default:l(()=>[t(w,{icon:"ri-edit-box-line",title:"Editar"})]),_:2},1032,["to"])]),bottom:l(()=>[t(k),m("div",te,[m("div",ae,[e[9]||(e[9]=c(" Filas por página: ")),t(Y,{modelValue:a(r),"onUpdate:modelValue":e[0]||(e[0]=i=>f(r)?r.value=i:null),class:"per-page-select",variant:"plain",items:[10,20,25,50,100]},null,8,["modelValue"])]),m("p",oe,C(("paginationMeta"in o?o.paginationMeta:a(q))({page:a(s),itemsPerPage:a(r)},a(p))),1),m("div",ie,[t(V,{class:"flip-in-rtl",icon:"ri-arrow-left-s-line",variant:"text",density:"comfortable",color:"high-emphasis",disabled:a(s)<=1,onClick:e[1]||(e[1]=i=>a(s)<=1?s.value=1:s.value--)},null,8,["disabled"]),t(V,{class:"flip-in-rtl",icon:"ri-arrow-right-s-line",density:"comfortable",variant:"text",color:"high-emphasis",disabled:a(s)>=Math.ceil(a(p)/a(r)),onClick:e[2]||(e[2]=i=>a(s)>=Math.ceil(a(p)/a(r))?s.value=Math.ceil(a(p)/a(r)):s.value++)},null,8,["disabled"])])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),t(z,{isDialogVisible:a(v),"onUpdate:isDialogVisible":e[5]||(e[5]=i=>f(v)?v.value=i:null),confirmationQuestion:"¿Está seguro que desea eliminar la factura seleccionada?",onConfirm:o.deleteFactura},null,8,["isDialogVisible","onConfirm"]),t(W,{modelValue:a(u),"onUpdate:modelValue":e[8]||(e[8]=i=>f(u)?u.value=i:null),width:"500"},{default:l(()=>[t(F,{class:"pa-sm-9 pa-3"},{default:l(()=>[t(A,{variant:"text",size:"default",onClick:e[6]||(e[6]=i=>u.value=!1)}),t(B,{class:"pt-5"},{default:l(()=>[e[13]||(e[13]=m("div",{class:"text-center pb-6"},[m("h4",{class:"text-h4 mb-2"}," Confirmación de cambio de año fiscal ")],-1)),t(Z,{onSubmit:Q(o.cambiarAnioModal,["prevent"])},{default:l(()=>[t(ee,null,{default:l(()=>[t($,{cols:"12"},{default:l(()=>e[10]||(e[10]=[m("div",{class:"text-center",style:{"font-size":"18px"}}," ¿Estás seguro que deseas cambiar el año fiscal? ",-1)])),_:1}),t($,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[t(V,{type:"submit",loading:a(E)[2]},{default:l(()=>e[11]||(e[11]=[c(" Aceptar ")])),_:1},8,["loading"]),t(V,{color:"secondary",variant:"outlined",onClick:e[7]||(e[7]=i=>u.value=!1)},{default:l(()=>e[12]||(e[12]=[c(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{Je as default};
